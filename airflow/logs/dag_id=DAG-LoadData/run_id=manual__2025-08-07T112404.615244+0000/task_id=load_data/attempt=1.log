{"timestamp":"2025-08-07T11:24:05.937187","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-07T11:24:05.938748","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/loadData.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-07T11:24:06.034944","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-08-07T11:24:06.354582","level":"info","event":"Connection Retrieved 'sqlserver'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-07T11:24:06.424218","level":"warning","event":"⚠️ Ligne ignorée : nombre de colonnes incorrect (1)","logger":"airflow.utils.log.logging_mixin.LoggingMixin"}
{"timestamp":"2025-08-07T11:24:06.443228","level":"error","event":"❌ Échec de l'insertion du dernier batch : ('23000', '[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]L\\'instruction INSERT est en conflit avec la contrainte FOREIGN KEY \"FK_Personne_Physique_Etat_Civil_etat_civil\". Le conflit s\\'est produit dans la base de données \"CreditDeclaration\", table \"dbo.Etat_Civil\", column \\'code\\'. (547) (SQLExecDirectW)')","logger":"airflow.utils.log.logging_mixin.LoggingMixin"}
{"timestamp":"2025-08-07T11:24:06.487268","level":"error","event":"❌ Ligne rejetée: ('161', '000030', 'NOUFEL                                            ', 'SOULEYMANI                                        ', '09/09/1991', '0', '12864', 'N', '1', '1', '012', '01', '001', 'ABDELKADER                                        ', 'DJAMILA                                           ', 'TAHRI                                             ', '1', '                                                  ', '213', '000000000000153000', '25 RUE ABDELHAMID BEN BADIS                       NOUVELLE VILLE                                    ', '01', '001', '002', '101513800           ', '012', 'CONSTANTINE                                                                                                                                                                                             ', '25/10/2026', '                    ', '012002101513800           ', '11250011286409091991') | Erreur: ('23000', '[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]L\\'instruction INSERT est en conflit avec la contrainte FOREIGN KEY \"FK_Personne_Physique_Etat_Civil_etat_civil\". Le conflit s\\'est produit dans la base de données \"CreditDeclaration\", table \"dbo.Etat_Civil\", column \\'code\\'. (547) (SQLExecDirectW)')","logger":"airflow.utils.log.logging_mixin.LoggingMixin"}
{"timestamp":"2025-08-07T11:24:06.490807","level":"warning","event":"⚠️ 1 lignes rejetées sauvegardées dans /opt/airflow/dags/data/rejected_rows_20250807_112406.txt","logger":"airflow.utils.log.logging_mixin.LoggingMixin"}
{"timestamp":"2025-08-07T11:24:06.491048","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"NameError","exc_value":"name 'MIMEMultipart' is not defined","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":825,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1088,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/loadData.py","lineno":225,"name":"readFile"},{"filename":"/opt/airflow/dags/loadData.py","lineno":143,"name":"insertDatabase"},{"filename":"/opt/airflow/dags/loadData.py","lineno":166,"name":"send_error_email"}]}]}
